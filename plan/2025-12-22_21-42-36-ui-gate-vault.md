---
mode: plan
task: Gate → Vault UI
created_at: "2025-12-22T21:43:07-05:00"
complexity: medium
---

# Plan: Gate → Vault UI

## Goal
- Landing page feels premium and calm: users see only the next relevant action.
- Implement strict UI gating:
  - Free scene locked until a Free Pass (id 0) is owned.
  - Premium scene shown locked (blur + lock) until a Premium Pass (id 1) is owned.
- Preserve the project’s high aesthetics; avoid “padding bloat”.

## Scope
- In:
  - Progressive disclosure by connection/network state.
  - Replace always-visible “Mint Flow” + “Pass Snapshot” cards with a collapsed “Details” panel.
  - Add reusable lock-overlay component for gated scenes.
  - Update Jest + Playwright coverage for new states.
- Out:
  - Backend/content encryption.
  - Marketplace metadata work.

## Assumptions / Dependencies
- Frontend lives under `apps/web/` and is static-exported via `next.config.ts`.
- Existing mint + read logic remains (wagmi hooks stay; no contract changes).
- Minimal new UI primitives: prefer existing `Button`/`Card`; avoid adding shadcn components unless necessary.

## Phases
1. Restructure page into “Gate” and “Vault” zones.
2. Implement gating rules + lock overlays.
3. Collapse technical details into an optional panel.
4. Polish spacing/typography/borders for breathability.
5. Update tests + run verification.

## Tests & Verification
- `cd apps/web && npm run test` -> Jest unit/UI tests pass.
- `cd apps/web && npm run build` -> static export succeeds.
- `cd apps/web && npx playwright test` -> gating/responsive smoke passes.

## Issue CSV
- Path: issues/2025-12-22_21-42-36-ui-gate-vault.csv
- Must share the same timestamp/slug as this plan.

## Tools / MCP
- `playwright:*` -> check responsive/gating behavior.
- `chrome-devtools:*` -> debug layout regressions if needed.
- Gemini CLI (consulted) -> UI progressive disclosure recommendations.

## Acceptance Checklist
- [ ] Disconnected: Hero (“Gate”) is visible; Vault cards are visible but locked with a Connect overlay.
- [ ] Wrong chain: show Switch-to-Base CTA; Vault cards are visible but locked with a Switch overlay.
- [ ] Connected on Base:
  - [ ] Show vault section.
  - [ ] Free card locked until `freeBalance > 0`.
  - [ ] Premium card locked (blur + lock) until `premiumBalance > 0`.
- [ ] “Mint Flow” and “Pass Snapshot” are not always visible; they are behind a toggle.
- [ ] Mobile and desktop look less busy (fewer always-visible panels; clearer hierarchy).
- [ ] No change to contract behavior; mint/claim still works.

## Risks / Blockers
- Lock overlays may add render cost on mobile if WebGL scenes mount underneath; if needed, switch to placeholder render until unlocked.
- Copy/layout changes may require updating existing Jest assertions.

## Rollback / Recovery
- Revert changes to `apps/web/src/app/page.tsx` and new overlay component(s); contract is untouched.

## Checkpoints
- Commit after: gating structure + overlays.
- Commit after: tests updated + build verified.

## References
- `apps/web/src/app/page.tsx`
- `apps/web/src/components/floating-nav.tsx`
- `apps/web/src/components/scenes/registry.ts`
- `apps/web/next.config.ts`
